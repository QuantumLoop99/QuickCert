<!-- certificate-verification.component.html -->
<app-header></app-header>

<div class="verification-page">
  <div class="verification-container">
    <div class="verification-header">
      <h2>Certificate Verification</h2>
      <p>Verify the authenticity of QuickCERT income statements and pension reports</p>
    </div>

    <div class="verification-content">
      <!-- Verification Form -->
      <div class="verification-form-card">
        <form [formGroup]="verificationForm" (ngSubmit)="verifyCertificate()">
          <label for="verificationCode">Verification Code *</label>
          <input id="verificationCode" formControlName="verificationCode" placeholder="Enter QC code..." />
          <button type="submit" [disabled]="isLoading">
            {{ isLoading ? 'Verifying...' : 'Verify Certificate' }}
          </button>
          <div class="error" *ngIf="error">{{ error }}</div>
        </form>
      </div>

      <!-- Verification Result -->
      <div class="verification-result-card" *ngIf="verificationResult">
        <h3>‚úÖ Certificate Verified</h3>

        <section class="info-section">
          <h4>üìã Certificate Info</h4>
          <p><strong>Reference No:</strong> {{ verificationResult.reference_no }}</p>
          <p><strong>Type:</strong> {{ verificationResult.request_type | titlecase }}</p>
          <p><strong>Status:</strong> {{ getStatusText(verificationResult.status || 'ds_approved') }}</p>
          <p><strong>Issued:</strong> {{ verificationResult.created_at | date:'mediumDate' }}</p>
        </section>

        <section class="info-section">
          <h4>üë§ Citizen Info</h4>
          <p><strong>Name:</strong> {{ verificationResult.name }}</p>
          <p *ngIf="verificationResult.nic"><strong>NIC:</strong> {{ verificationResult.nic }}</p>
          <p *ngIf="verificationResult.address"><strong>Address:</strong> {{ verificationResult.address }}</p>
        </section>

        <section class="info-section">
          <h4>üìÑ Request Info</h4>
          <p *ngIf="verificationResult.reason"><strong>Purpose:</strong> {{ verificationResult.reason }}</p>
          <p *ngIf="verificationResult.income_year"><strong>Year:</strong> {{ verificationResult.income_year }}</p>
          <p *ngIf="verificationResult.pension_type"><strong>Pension Type:</strong> {{ verificationResult.pension_type }}</p>
          <p *ngIf="verificationResult.pension_number"><strong>Pension Number:</strong> {{ verificationResult.pension_number }}</p>
        </section>

        <section class="info-section">
          <h4>üîê Verified</h4>
          <p>This certificate is digitally signed and verified by the Government of Sri Lanka.</p>
          <p><strong>Checked at:</strong> {{ currentDate | date:'medium' }}</p>
        </section>
      </div>
    </div>
  </div>
</div>
